<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Accelerometer Background</title>
    <style>
      body {
        margin: 0;
        padding: 0;
        background-color: lightblue;
        overflow: hidden;
      }

      .indicatorDot {
        width: 30px;
        height: 30px;
        background-color: #ffab56;
        border-radius: 50%;
        position: fixed;
        pointer-events: none;
      }
    </style>
  </head>
  <body>
    <div class="indicatorDot" style="left: 30%; top: 30%"></div>

    <script>
      var px = 50;
      var py = 50;
      var vx = 0.0;
      var vy = 0.0;
      var updateRate = 1 / 60;

      function startMotionTracking() {
        if (
          typeof DeviceMotionEvent !== "undefined" &&
          typeof DeviceMotionEvent.requestPermission === "function"
        ) {
          DeviceMotionEvent.requestPermission().then((response) => {
            if (response === "granted") {
              window.addEventListener("deviceorientation", updateDot);
            }
          });
        } else {
          // for Android or non-permission browsers
          window.addEventListener("deviceorientation", updateDot);
        }
      }

      function updateDot(event) {
        let frontToBack_degrees = event.beta;
        let leftToRight_degrees = event.gamma;

        vx = vx + leftToRight_degrees * updateRate * 2;
        vy = vy + frontToBack_degrees * updateRate;

        px = px + vx * 0.5;
        py = py + vy * 0.5;

        // Clamp positions
        px = Math.max(0, Math.min(98, px));
        py = Math.max(0, Math.min(98, py));

        if (px === 0 || px === 98) vx = 0;
        if (py === 0 || py === 98) vy = 0;

        let dot = document.querySelector(".indicatorDot");
        dot.style.left = px + "%";
        dot.style.top = py + "%";
      }

      window.addEventListener("load", () => {
        startMotionTracking();
      });
    </script>
  </body>
</html>
